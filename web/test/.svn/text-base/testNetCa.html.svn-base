<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<META HTTP-EQUIV="Cache-Control" CONTENT="no-cache"> 
<META HTTP-EQUIV="Expires" CONTENT="0">
<style type="text/css">
<!--
.STYLE2 {font-size: xx-small}
-->
</style>
<script type="text/javascript" src="../base/js/ca.js"></script>
</HEAD>

<script language="javascript">

function installed(){
  ca.installed();
}

function getReadId(){
  var keyId=document.getElementById("keyId");
  keyId.value=ca.readId();
}

function check_(){
  var pwd=document.getElementById("pwd");
  var readId = ca.check(pwd.value);
  if(readId){
     alert('密码匹配成功');
	 document.getElementById("readId").value=readId;
  }else
     alert('密码匹配失败');
}
function sign(){
	var tempStr=ca.sign(form1.en_.value,1);
	if(tempStr==undefined||tempStr==null){
		alert("签名失败!");
	}else{
		alert("签名长度："+tempStr.length);
		form1.en1_.value=tempStr;
		alert("签名成功!");
	}
}
function verify(){
	var tempStr=ca.verify(form1.en_.value,form1.en1_.value,1);
	if(!tempStr){
		alert("签名验证失败!");
	}else{
		form1.dec_.value=form1.en_.value
		alert("签名验证成功!");
	}
}
function encode(){
	var tempStr=ca.encode(document.getElementById("keyId").value,form1.en11_.value);
	if(tempStr==undefined||tempStr==null){
		alert("加密失败!");
	}else{
		alert("加密长度："+tempStr.length);
		form1.en12_.value=tempStr;
		alert("加密成功!");
	}
}
function decode(){
	var tempStr=ca.decode(form1.en12_.value);
	if(!tempStr){
		alert("解密失败!");
	}else{
		form1.dec11_.value=tempStr;
		alert("解密成功!");
	}
}
</script>
<BODY>


<form name=form1>
<input type=hidden name=subData value="">
<input type=hidden name=srcData value="">
<table 	width="897" align="center"  border="1"  cellspacing=1 cellpadding=1>

<tr>
	<td align="middle" width="102"><INPUT name=pincode2 type=button  style="HEIGHT: 22px; WIDTH: 102px" value="installed"  onclick="installed()"></td>
	<td width="312" colspan="2">检查是否安装驱动</td>
</tr>

<tr>
	<td align="middle" width="102"><INPUT name=pincode2 type=button  style="HEIGHT: 22px; WIDTH: 102px" value="getReadId"  onclick="getReadId()"></td>
	<td width="312"><INPUT name=keyId id="keyId" type=test  style="HEIGHT: 22px; WIDTH: 100%" ENC=Y SIG=Y value="" onMouseOver=this.focus() onFocus=this.select()>	</td>
    <td width="465"><span class="STYLE2">获取密钥唯一编码（缩略图）</span></td>
</tr>

<tr>
  <td><INPUT name=keyId id="keyId" type=button  style="HEIGHT: 22px; WIDTH: 102px" value="check"  onclick="check_()"></td>
  <td>readId<INPUT name=readId id="readId"><br>pwd<INPUT name=pwd id="pwd" type=test value="12345678"  ></td>
  <td><span class="STYLE2">检查密码是否匹配</span></td>
</tr>

<tr>
  <td><input value="sign" type=button  style="HEIGHT: 22px; WIDTH: 102px"  onClick="sign();"></td>
  <td><INPUT name="en_" id="en_" type=test  style="HEIGHT: 22px; WIDTH: 100%" ENC=Y SIG=Y value="TEST"><INPUT name="en1_" id="en1_" type=test  style="HEIGHT: 22px; WIDTH: 100%" ENC=Y SIG=Y value=""></td>
  <td><span class="STYLE2">签名处理</span></td>
</tr>
<tr>
  <td><input value="verify" type=button  style="HEIGHT: 22px; WIDTH: 102px"  onClick="verify();"></td>
  <td><INPUT name="dec_" id="dec_" type=test  style="HEIGHT: 22px; WIDTH: 100%" ENC=Y SIG=Y value=""></td>
  <td><span class="STYLE2">签名验证</span></td>
</tr>

<tr>
  <td><input type=button style="HEIGHT: 22px; WIDTH: 100%" value="encode"  onClick="encode();"></td>
  <td><INPUT name="en11_" id="en11_" style="HEIGHT: 22px; WIDTH: 100%" ENC=Y SIG=Y value="TEST">
  		<INPUT name="en12_" id="en12_" type=test  style="HEIGHT: 22px; WIDTH: 100%" ENC=Y SIG=Y value=""></td>
  <td><span class="STYLE2">加密</span></td>
</tr>
<tr>
  <td><input type=button style="HEIGHT: 22px; WIDTH: 100%" value="decode" onClick="decode();"></td>
  <td><INPUT name="dec11_" id="dec11_" type=test  style="HEIGHT: 22px; WIDTH: 100%" ENC=Y SIG=Y value=""></td>
  <td><span class="STYLE2">解密</span></td>
</tr>
<tr>
  <td>&nbsp;</td>
  <td>&nbsp;</td>
  <td>&nbsp;</td>
</tr>
<tr>

	<td colspan="3">
	  <p align="center">&nbsp;&nbsp;		</p>	</td>
</tr>
</table>
</form>
</BODY>
</HTML>
